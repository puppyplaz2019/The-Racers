<!DOCTYPE html>
<html>
<head>
    <title>Estate V66 - High Shine Gold</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Segoe UI', sans-serif; }
        #ui { position: absolute; top: 10px; left: 10px; color: #fff; background: rgba(0,0,0,0.85); padding: 15px; border-radius: 10px; border-left: 5px solid #FFD700; pointer-events: none; }
        #tipBox { position: absolute; top: 10px; right: 10px; pointer-events: auto; }
        #overlay { position: absolute; width: 100%; height: 100%; background: #000; color: white; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; }
        .btn { padding: 15px 40px; font-size: 20px; cursor: pointer; background: #FFD700; border: none; color: #000; font-weight: bold; border-radius: 5px; }
        #msg { position: absolute; top: 40%; width: 100%; text-align: center; color: #FFD700; font-size: 28px; font-weight: bold; opacity: 0; pointer-events: none; }
    </style>
</head>
<body>

    <div id="overlay">
        <h1>ESTATE V66</h1>
        <p>Reflective Gold Logic | Receipt Required</p>
        <button class="btn" onclick="start()">START WORLD</button>
    </div>

    <div id="ui">
        <b>W / S</b>: Forward / Back | <b>A / D</b>: Turn<br>
        <b>Radio</b>: M | <b>Drive</b>: E<br>
        <b>Paint</b>: <span id="carStatus" style="color:#e74c3c">Standard Red</span>
    </div>

    <div id="tipBox">
        <button style="padding:10px 20px; cursor:pointer; background:#FFD700; border:none; font-weight:bold;" onclick="verifyReceipt()">ðŸ’° ENTER RECEIPT</button>
    </div>

    <div id="msg">SHINE UNLOCKED</div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        let scene, camera, renderer, car, carBody, keyStack = [];
        let playerYaw = 0, playerPitch = 0, vy = 0, isJumping = false, isDriving = false;

        function start() { document.getElementById('overlay').style.display = 'none'; init(); }

        function init() {
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x87CEEB);

            camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
            camera.position.set(0, 5, 10);

            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.outputEncoding = THREE.sRGBEncoding; // Enables richer colors
            document.body.appendChild(renderer.domElement);

            // BRIGHT LIGHTS (Required for shine)
            scene.add(new THREE.AmbientLight(0xffffff, 0.4));
            const mainLight = new THREE.DirectionalLight(0xffffff, 1.5);
            mainLight.position.set(10, 20, 10);
            scene.add(mainLight);

            const fillLight = new THREE.PointLight(0xffffff, 1);
            fillLight.position.set(-10, 10, -10);
            scene.add(fillLight);

            const floor = new THREE.Mesh(new THREE.PlaneGeometry(1000, 1000), new THREE.MeshStandardMaterial({color: 0x222222}));
            floor.rotation.x = -Math.PI/2; 
            scene.add(floor); 

            createCar();

            window.addEventListener('keydown', e => {
                if (!keyStack.includes(e.code)) keyStack.push(e.code);
                if (e.code === 'KeyE') isDriving = !isDriving;
                if (e.code === 'Space' && !isJumping) { vy = 0.5; isJumping = true; }
            });
            window.addEventListener('keyup', e => keyStack = keyStack.filter(k => k !== e.code));

            loop();
        }

        function createCar() {
            car = new THREE.Group();
            // Start as Red Plastic
            carBody = new THREE.Mesh(
                new THREE.BoxGeometry(4, 2, 7), 
                new THREE.MeshStandardMaterial({color: 0xc0392b, metalness: 0, roughness: 1})
            );
            carBody.position.y = 1; car.add(carBody);
            car.position.set(0, 0, 0);
            scene.add(car);
        }

        function verifyReceipt() {
            let input = prompt("Receipt Code:");
            if (input === "DEV-MWUNR0XT6-100") {
                // THE SHINE SETTINGS
                carBody.material.color.setHex(0xFFD700);
                carBody.material.metalness = 1.0;  // Pure metal
                carBody.material.roughness = 0.05; // Like a mirror
                
                // Add "Internal Reflection" fake (Emissive)
                carBody.material.emissive.setHex(0x554400); 
                carBody.material.emissiveIntensity = 0.5;

                document.getElementById('carStatus').innerText = "24K BULLION GOLD";
                document.getElementById('carStatus').style.color = "#FFD700";
                document.getElementById('msg').style.opacity = 1;
                setTimeout(() => { document.getElementById('msg').style.opacity = 0; }, 2000);
            }
        }

        function loop() {
            requestAnimationFrame(loop);
            const topKey = keyStack[keyStack.length - 1];

            const speed = 0.4;
            const dir = new THREE.Vector3();
            camera.getWorldDirection(dir);
            dir.y = 0; dir.normalize();

            if (topKey === 'KeyW') {
                if(isDriving) car.position.add(dir.clone().multiplyScalar(speed * 2));
                else camera.position.add(dir.clone().multiplyScalar(speed));
            } 
            else if (topKey === 'KeyS') {
                if(isDriving) car.position.sub(dir.clone().multiplyScalar(speed * 2));
                else camera.position.sub(dir.clone().multiplyScalar(speed));
            } 
            else if (topKey === 'KeyA') playerYaw += 0.04;
            else if (topKey === 'KeyD') playerYaw -= 0.04;
            else if (topKey === 'ArrowUp') playerPitch = Math.min(playerPitch + 0.04, 1.5);
            else if (topKey === 'ArrowDown') playerPitch = Math.max(playerPitch - 0.04, -1.5);

            if(!isDriving) {
                camera.position.y += vy;
                if(isJumping) vy -= 0.025;
                if(camera.position.y <= 5) { camera.position.y = 5; vy = 0; isJumping = false; }
            }

            if(isDriving) {
                car.rotation.y = playerYaw - Math.PI;
                camera.position.set(car.position.x - Math.sin(playerYaw)*12, car.position.y + 6, car.position.z - Math.cos(playerYaw)*12);
                camera.lookAt(car.position);
            } else {
                camera.rotation.order = 'YXZ';
                camera.rotation.y = playerYaw;
                camera.rotation.x = playerPitch;
            }
            renderer.render(scene, camera);
        }
    </script>
</body>
</html>
